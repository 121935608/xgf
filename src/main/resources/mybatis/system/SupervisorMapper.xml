<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="SupervisorMapper">

    <resultMap type="Supervisor" id="SupervisorResult">
        <result property="supervisorId" column="supervisorId" />
        <result property="name" column="name" />
        <result property="phone" column="phone" />
        <result property="area" column="area" />
        <result property="status" column="status" />
        <result property="creatTime" column="creatTime" />
        <result property="supervisorNum" column="supervisorNum" />
    </resultMap>


    <select id="pageInfoQuery" parameterType="PageUtilEntity" resultMap="SupervisorResult">
        SELECT supervisorId,name,phone,area,status,supervisorNum FROM sys_supervisor
        WHERE 1=1
        <if test="relationMap.status!=null and relationMap.status !=''">
            AND status =#{relationMap.status}
        </if>
        <if test="relationMap.userName!=null and relationMap.userName!=''">
            AND
            (
            name LIKE CONCAT(CONCAT('%', #{relationMap.userName}),'%')
            OR
            supervisorNum LIKE CONCAT(CONCAT('%', #{relationMap.userName}),'%')
            OR
            phone LIKE CONCAT(CONCAT('%', #{relationMap.userName}),'%')
            )
        </if>
    </select>

    <update id="updateSupervisor" parameterType="Supervisor">
        UPDATE sys_supervisor
        <set>
            <if test="name !=null and name!=''">name =#{name},</if>
            <if test="phone !=null and phone!=''">phone =#{phone},</if>
            <if test="area !=null and area!=''">area =#{area},</if>
            <if test="status !=null">status =#{status},</if>
            <if test="supervisorNum !=null and supervisorNum!=''">supervisorNum =#{supervisorNum}</if>
            creatTime=sysdate()
        </set>
        WHERE 1=1
        <if test="supervisorId !=null">
            AND supervisorId=#{supervisorId}
        </if>
    </update>

    <select id="findSupervisor" resultType="Supervisor">
        SELECT * FROM sys_supervisor WHERE supervisorId=#{supervisorId}
    </select>

    <insert id="addSupervisor" parameterType="Supervisor">
        INSERT INTO sys_supervisor(
          <if test="name !=null and name!=''">name,</if>
          <if test="phone !=null and phone!=''">phone,</if>
          <if test="area !=null and area!=''">area,</if>
          <if test="status !=null and status!=''">status,</if>
          <if test="supervisorNum !=null and supervisorNum!=''">supervisorNum,</if>
          creatTime
        )VALUES (
        <if test="name !=null and name!=''">#{name},</if>
        <if test="phone !=null and phone!=''">#{phone},</if>
        <if test="area !=null and area!=''">#{area},</if>
        <if test="status !=null and status!=''">#{status},</if>
        <if test="supervisorNum !=null and supervisorNum!=''">#{supervisorNum},</if>
        sysdate()
        )
    </insert>

    <select id="findPhone" parameterType="Supervisor" resultType="Supervisor">
        SELECT * FROM sys_supervisor WHERE phone=#{phone}
        <if test="supervisorId !=null">
            AND supervisorId !=#{supervisorId}
        </if>
    </select>
</mapper>