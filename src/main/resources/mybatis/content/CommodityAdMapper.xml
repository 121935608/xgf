<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="ContentCommodityAdMapper">

	<resultMap type="CommodityAd" id="CommodityAdResult">
		<result property="carouselId" column="carouselId" />
		<result property="carouselName" column="carouselName" />
		<result property="sort" column="sort" />
		<result property="carouselImg" column="carouselImg" />
		<result property="visitNum" column="visitNum" />
		<result property="createTime" column="createTime" />
		<result property="updateTime" column="updateTime" />
		<result property="status" column="status" />
		<result property="url" column="url" />
		<result property="carouselNum" column="carouselNum" />
	</resultMap>
	
	<delete id="deleteCommodityAdInfo" parameterType="CommodityAd">
 		delete from t_commodityAd where 1=1
 		<if test="commodityAdId != null and commodityAdId  != ''">and commodityAdId = #{commodityAdId}</if>
 	</delete>

	<select id="findByCommodityAdId" parameterType="String"
		resultType="CommodityAd">
		select * from t_commodityAd where
		commodityAdId=#{commodityAdId}
	</select>

	<select id="pageInfoQuery" parameterType="PageUtilEntity"
		resultType="CommodityAd" useCache="false">
		SELECT a.floor,a.type,a.commodityAdName,a.createTime,a.status
		from
		t_commodityAd a
		left join t_commodity b on a.commodityId=b.commodityId
		WHERE 1=1


		<if test="relationMap.beginTime != null and relationMap.beginTime != ''">
			AND DATE_FORMAT(createTime,'%Y%m%d') &gt;=
			DATE_FORMAT(#{relationMap.beginTime},'%Y%m%d')
		</if>
		<if test="relationMap.endTime != null and relationMap.endTime != ''">
			AND DATE_FORMAT(createTime,'%Y%m%d') &lt;=
			DATE_FORMAT(#{relationMap.endTime},'%Y%m%d')
		</if>

		<if test="relationMap.type != null and relationMap.type != ''">
			AND type = #{relationMap.type}
		</if>
		<if test="relationMap.status != null and relationMap.status != ''">
			AND status = #{relationMap.status}
		</if>
		<if
			test="relationMap.fuzzyCondition != null and relationMap.fuzzyCondition != ''">
			AND (
			commodityAdName LIKE CONCAT(CONCAT('%',
			#{relationMap.fuzzyCondition}),'%')
			)
		</if>
	</select>

	<!-- 修改信息 -->
	<update id="updateCommodityAdInfo" parameterType="CommodityAd">
		update t_commodityAd
		<set>
			<if test="commodityAdName != null and commodityAdName != ''">
				commodityAdName = #{commodityAdName},
			</if>
			<if test="commodityAdImg != null and commodityAdImg != ''">
				commodityAdImg = #{commodityAdImg},
			</if>
			<if test="url != null and url != ''">
				url = #{url},
			</if>
			<if test="type != null and type != ''">
				type = #{type},
			</if>
			<if test="createTime != null and createTime != ''">
				createTime = #{createTime},
			</if>
			<if test="updateTime != null and updateTime != ''">
				updateTime = #{updateTime},
			</if>
			<if test="status.toString() != null and status.toString() != ''">
				status = #{status},
			</if>
			<if test="commodityDes != null and commodityDes != ''">
				commodityDes = #{commodityDes},
			</if>
			<if test="floor != null and floor != ''">
				floor = #{floor}
			</if>
			<if test="sort != null and sort != ''">
				sort = #{sort}
			</if>

		</set>
		where 1=1
		<if test="commodityAdId != null and commodityAdId  != ''">
			and commodityAdId = #{commodityAdId}
		</if>
	</update>

	<!-- 插入信息 -->
	<insert id="addCommodityAdInfo" parameterType="CommodityAd"
		keyProperty="commodityAdId">
		<selectKey keyProperty="commodityAdId" resultType="java.lang.String"
			order="BEFORE">
			select uuid()
		</selectKey>
		insert into t_commodityAd
		( commodityAdId,
		<if test="commodityAdName != null and commodityAdName != ''">commodityAdName,</if>
		<if test="commodityAdImg != null and commodityAdImg != ''">commodityAdImg,</if>
		<if test="url != null and url != ''">url,</if>
		<if test="type != null and type != ''">type,</if>
		createTime,updateTime,
		<if test="status != null and status != ''">status,</if>
		<if test="commodityDes != null and commodityDes != ''">commodityDes,</if>
		<if test="floor != null and floor != ''">floor,</if>
		<if test="sort != null and sort != ''">sort</if>
		)values(#{commodityAdId},
		<if test="commodityAdName != null and commodityAdName != ''">#{commodityAdName},</if>
		<if test="commodityAdImg != null and commodityAdImg != ''">#{commodityAdImg},</if>
		<if test="url != null and url != ''">#{url},</if>
		<if test="type != null and type != ''">#{type},</if>
		sysdate(),sysdate(),
		<if test="status != null and status != ''">#{status},</if>
		<if test="commodityDes != null and commodityDes != ''">#{commodityDes},</if>
		<if test="floor != null and floor != ''">#{floor},</if>
		<if test="sort != null and sort != ''">#{sort}</if>

		)
	</insert>

</mapper> 